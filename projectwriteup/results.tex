Our initial trial run of the fingerprinting and candidate selection step proved to match expectations, with 100\% correctly determined IP results compared to what Shodan reports as those potentially vulnerable to BlueKeep out of a sample test set of 25 IP addresses. Out of 50, we fingerprinted 93\% of the OS versions the same when compared to Shodan however, 1 of the conflicting IP addresses did not have port 3389 open at time of scanning. As previously explained, the IPs with open port 3389 and with a Windows OS Windows XP to Windows 7 are selected as our candidates for further exploration out of a larger set of IP addresses. We do this by sending IP/SYN packets via Scapy to this set of discovered IP addresses and fingerprint them with Scapy's p0f tool. The IP addresses that pass our filters can then be piped into our patch scanner to determine if they are running RDP and if so, is the machine properly patched.

For the chosen BlueKeep vulnerability, we expect to see a more homogeneous group machines as the CVE applicable only for older OS without a patch. At a count of almost 500 thousand Windows systems still vulnerable as reported by Shodan, a number still half of the original release, we expect to find comparable ratios of vulnerable machines in our network scans, especially as BlueKeep was announced in Q1 of 2019. We also expect the detected machines to be running older websites, deprecated web stacks, and similar such dated endpoints. Additionally, these machines should be more likely to have high numbers of other possible vulnerabilities due to update neglect indicated by the lack of a BlueKeep patch. Since Windows 7 SP1 is the latest version affected by BlueKeep, we also expect to see vulnerable machines congregated in countries with poorer internet infrastructure as they will be those more likely to run a host OS released before 2012.
Since BlueKeep only targets Windows machines ranging from Windows Server 2008 to Windows 7, we need to properly fingerprint each IP's host machine to determine likely candidates for this vulnerability. However, the header fields in the http request/responses may not be accurate. To increase confidence and properly identify the host machine OS, we can use an approach described by Han and Du (2010)~\cite{han_du_2010} which identifies OS by TCP/IP fingerprint. This paper uses a method in which a host can be fingerprinted via an open TCP port. The method described in this approach constructs a TCP packet, initiates a connection handshake protocol, and records the protocol fingerprints found in the TCP response header. Once recorded, the data gathered is used to compare the behavior with a database of OS fingerprints to accurately judge the host OS type and version. Similarly, the paper by Shamsi, Nandwani, Leonard, and Loguinov (2014)~\cite{zain_ankur_derek_log_2014} also describes a method of properly fingerprinting networks, but this time in the context of improving accuracy of the packet pipeline in the presence of non-ideal network conditions as we would encounter. There are quite a few limitations and mitigation steps revolving around this network latency as well as user modifications which affect the results however in general, the fingerprint method seems well-researched. These two options, when implemented properly, would greatly increase the certainty we would have when filtering out host OS compared to just using the headers.

Once the OS has been fingerprinted, the next step is to examine the system for the BlueKeep vulnerability. BlueKeep relies on RDP being installed on the host machine however, there are a few key indicators of vulnerability. The packet handling of RDP communications requires several modules, among them termdd.sys, a driver used to send mouse and keyboard actions. Upon further exploration, researchers discovered a channel named MS\_T120 contained a vulnerability in which if a specially crafted packet is sent, the channel itself is freed. However, the pointer to the function is not freed and thus can be accessed on the channel, thus bypassing any prior authentication~\cite{go_zingbox_com_2019}. A scanner for BlueKeep can therefore bind this MS\_T120 channel, send appropriate packets, close the channel, and compare the output to that of a patched machine. If they differ, then the host can be classified as being vulnerable to BlueKeep~\cite{dillon_2019}. This approach for the scanner will be useful when searching for vulnerable machines out of those we have pre-filtered for OS and open port.

We also examined some works based around how BlueKeep exploits work and what they can do. In a paper released by Yan and Chen (2019)~\cite{yan_chen_2019}, they describe the impacts and risks of BlueKeep while also discussing the methodology of exploit potentially of use when building a network scanner to detect this CVE. They implement different methods of writing data into the host's kernel including via the Bitmap PDU, the Refresh PDU and the Client Name Request PDU, all abusing the ''use-after-free'' vulnerability previously described. The latter method is particularly useful as it enables an attacker to obtain a stable kernel pool which can be used to insert shell code. These risks can however be mitigated by the addition of traps while external scanning and exploitation of BlueKeep vulnerable hosts can be prevented and detected by the released patch. The exploits and methods discussed here give would be useful in the event we were not just scanning for vulnerable machines but also exploiting them.

Finally, we researched for papers discussing penetration testing and mitigation strategies on Windows Server in order to see how CVEs are detected and exploited on host machines in a Windows ecosystem as BlueKeep is a Windows only CVE. A paper by Stiawan, et al.~\cite{penetration_2016} discusses how they found 12 different vulnerabilities present on Windows server and the penetration testing techniques they used. Exploits began by fingerprinting the OS and network via IP address/subnet mask information, OS and running service then progressing to techniques for elevation of privilege, ranging from guessing to cracking the target password. They leverage tools including Metasploit, Cain and Abel, as well as Netcat to obtain these privileges. Finally, they note future work in the area of extracting and classifying system data to properly identify new attack vectors as well as exploring methods of classifying threats to better protect the system from future attacks.
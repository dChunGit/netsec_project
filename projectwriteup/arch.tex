Our tool will scan the network for vulnerable IPs by fingerprinting each OS, firstly by http header and secondly via methods including a TCP/IP/SYN method described by Han and Du (2010)~\cite{han_du_2010}. RDP requires port 3889 to be open and we can therefore proceed to filter by open ports. Once complete, the final step is to scan the filtered hosts for the BlueKeep vulnerability. This scan can consist of detecting the RDP is installed and then attempting a request/response comparison to check if the vulnerability has been patched or not. 

The way this patch scan works is by checking a message return from the host on receipt of a specially crafted packet which will differ if the host is safe or vulnerable. The scanner first authenticates with the host via a handshake protocol and connects to the MS\_T120 channel. Once we send a close channel command with a specified size, there are two possible outcomes. On a vulnerable machine, the host will close the channel properly, sending a disconnect packet. However, on a patched machine, the channel will not close and no disconnect packet is sent. Thus by waiting for a couple seconds, we can determine if the host has been patched or not.

Once we have detected a BlueKeep vulnerable machine, we can then proceed to extract holistic data about our targets, including OS version, other open ports, geographic location, among others. This data can then be used to aggregate common environment or network features which could give insight into the applicability, danger, and relevancy of BlueKeep.